---
title: "Genetic Correlation Plots"
author: "Jerry Duran"
date: "`r Sys.Date()`"
output: "github_document"
---

```{r}
# Load necessary library
library(ggplot2)
library(tidyr)
library(dplyr)

# Define the dataset
data <- data.frame(
  Frequency_comparison = c("250|500", "250|1000", "250|2000", "250|3000", "250|4000", "250|6000", 
                           "250|8000", "500|1000", "500|2000", "500|3000", "500|4000", "500|6000", 
                           "500|8000", "1000|2000", "1000|3000", "1000|4000", "1000|6000", 
                           "1000|8000", "2000|3000", "2000|4000", "2000|6000", "2000|8000", 
                           "3000|4000", "3000|6000", "3000|8000", "4000|6000", "4000|8000", "6000|8000"),
  
  Full_Pedigree_RhoG = c(0.81, 0.62, 0.66, 0.45, 0.53, 0.19, 
                         0.32, 0.80, 0.82, 0.56, 0.54, 0.14, 
                         0.31, 0.78, 0.55, 0.51, -0.05, 
                         0.12, 0.53, 0.53, 0.04, 0.16, 
                         0.72, 0.50, 0.55, 0.70, 0.66, 0.82),
  
  Full_Pedigree_SE = c(0.08, 0.11, 0.10, 0.07, 0.07, 0.08, 
                       0.08, 0.07, 0.07, 0.07, 0.07, 0.08, 
                       0.06, 0.08, 0.09, 0.10, 0.09, 
                       0.11, 0.13, 0.09, 0.08, 0.09, 
                       0.10, 0.08, 0.10, 0.10, 0.13, 0.08),
  
  Parent_offspring_RhoG = c(0.84, 0.61, 0.71, 0.45, 0.52, 0.12, 
                            0.25, 0.77, 0.82, 0.53, 0.50, 0.06, 
                            0.25, 0.76, 0.50, 0.51, -0.14, 
                            0.00, 0.55, 0.62, 0.05, 0.13, 
                            0.75, 0.50, 0.57, 0.65, 0.56, 0.80),
  
  Parent_offspring_SE = c(0.07, 0.09, 0.07, 0.09, 0.09, 0.09, 
                          0.10, 0.08, 0.06, 0.09, 0.09, 0.10, 
                          0.10, 0.10, 0.09, 0.09, 0.11, 
                          0.12, 0.08, 0.08, 0.10, 0.11, 
                          0.06, 0.09, 0.09, 0.07, 0.09, 0.09),
  
  Siblings_RhoG = c(0.86, 0.64, 0.73, 0.55, 0.54, 0.09, 
                    0.25, 0.80, 0.85, 0.56, 0.55, 0.15, 
                    0.31, 0.79, 0.59, 0.42, -0.22, 
                    0.05, 0.64, 0.62, 0.12, 0.16, 
                    0.74, 0.51, 0.67, 0.60, 0.58, 0.83),
  
  Siblings_SE = c(0.07, 0.08, 0.09, 0.08, 0.09, 0.13, 
                  0.11, 0.05, 0.08, 0.09, 0.09, 0.11, 
                  0.11, 0.07, 0.09, 0.10, 0.11, 
                  0.12, 007, 0.08, 0.10, 0.11, 
                  0.09, 0.10, 0.09, 0.11, 0.09, 0.12)
)
```

```{r split }



# Add diagonal entries to the data frame
diagonal_entries <- data.frame(
  Frequency_comparison = c("250|250", "500|500", "1000|1000", "2000|2000", "3000|3000", "4000|4000", "6000|6000", "8000|8000"),
  RhoG = c(1, 1, 1, 1, 1, 1, 1, 1)  # Perfect correlation on the diagonal
)

# Combine the initial data with the diagonal entries
data <- rbind(data, diagonal_entries)

# Split the 'Frequency_comparison' column into 'Freq1' and 'Freq2'
data <- separate(data, Frequency_comparison, into = c("Freq1", "Freq2"), sep = "\\|")

# Convert the split columns to numeric
data$Freq1 <- as.numeric(data$Freq1)
data$Freq2 <- as.numeric(data$Freq2)

# Define all frequencies to ensure axes include all values
all_frequencies <- c(250, 500, 1000, 2000, 3000, 4000, 6000, 8000)

# Create the heatmap with a smooth gradient from blue to red, centered at 0 (white)
new_heatmap <- ggplot(data, aes(x = factor(Freq2, levels = all_frequencies), 
                                y = factor(Freq1, levels = rev(all_frequencies)), 
                                fill = RhoG)) +
  geom_tile() +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", 
                       midpoint = 0, limits = c(-1, 1), 
                       breaks = seq(-1, 1, by = 0.5),
                       name = "Genetic Correlation") +
  scale_x_discrete(position = "top") +
  scale_y_discrete() +  
  labs(x = "Frequency", y = "Frequency") +
  ggtitle("") +
  theme_classic() +
  theme(axis.text.x = element_text(family = "Arial", vjust = 0.5, size = 20, face ="bold", hjust = 0.5, margin = margin(t = 10, r = 0, b = 0, l = 0)),
        axis.text.y = element_text(family = "Arial", size = 20, face ="bold", margin = margin(t = 0, r = 10, b = 0, l = 0)),
        axis.title.x = element_text(family = "Arial", size = 20, face ="bold", margin = margin(t = 10, r = 0, b = -10, l = 0)),
        axis.title.y = element_text(family = "Arial", size = 20, face ="bold", margin = margin(t = 10, r = 10, b = 0, l = 0)),
        plot.margin = margin(1, 1, 1, 1, "cm"),
        plot.title = element_text(family = "Arial", size = 20, hjust = 0.5, vjust = 1, face= "bold"),
        panel.grid.major = element_line(color = "gray", linetype = "dashed"),
        panel.border = element_rect(color = "black", fill = NA, size = 1))

# Save the plot as an image
ggsave("updated_heatmap_linear_full_family.png", plot = new_heatmap, width = 10, height = 7, dpi = 300)

# Display the plot
print(new_heatmap)


```

```{r}
##SOLAR_FULL_PED



# Create the initial data frame with the new data
data <- data.frame(
  Frequency_comparison = c("250|500", "250|1000", "250|2000", "250|3000", "250|4000", "250|6000", 
                           "250|8000", "500|1000", "500|2000", "500|3000", "500|4000", "500|6000", 
                           "500|8000", "1000|2000", "1000|3000", "1000|4000", "1000|6000", 
                           "1000|8000", "2000|3000", "2000|4000", "2000|6000", "2000|8000", 
                           "3000|4000", "3000|6000", "3000|8000", "4000|6000", "4000|8000", "6000|8000"),
  
  RhoG = c(0.796, 0.551, 0.748, 0.49, 0.502, 0.152, 
           0.205, 0.82, 0.896, 0.654, 0.628, 0.123, 
           0.303, 0.815, 0.5987, 0.5796, -0.046, 
           0.152, 0.6298, 0.606, 0.068, 0.201, 
           0.7599, 0.54, 0.519, 0.681, 0.61, 0.907)
)

# Add diagonal entries to the data frame
diagonal_entries <- data.frame(
  Frequency_comparison = c("250|250", "500|500", "1000|1000", "2000|2000", "3000|3000", "4000|4000", "6000|6000", "8000|8000"),
  RhoG = c(1, 1, 1, 1, 1, 1, 1, 1)  # Perfect correlation on the diagonal
)

# Combine the initial data with the diagonal entries
data <- rbind(data, diagonal_entries)

# Split the 'Frequency_comparison' column into 'Freq1' and 'Freq2'
data <- separate(data, Frequency_comparison, into = c("Freq1", "Freq2"), sep = "\\|")

# Convert the split columns to numeric
data$Freq1 <- as.numeric(data$Freq1)
data$Freq2 <- as.numeric(data$Freq2)

# Define all frequencies to ensure axes include all values
all_frequencies <- c(250, 500, 1000, 2000, 3000, 4000, 6000, 8000)

# Create the heatmap with a smooth gradient from blue to red, centered at 0 (white)
new_heatmap <- ggplot(data, aes(x = factor(Freq2, levels = all_frequencies), 
                                y = factor(Freq1, levels = rev(all_frequencies)), 
                                fill = RhoG)) +
  geom_tile() +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", 
                       midpoint = 0, limits = c(-1, 1), 
                       breaks = seq(-1, 1, by = 0.5),
                       name = "Genetic Correlation") +
  scale_x_discrete(position = "top") +
  scale_y_discrete() +  
  labs(x = "Frequency", y = "Frequency") +
  ggtitle("") +
  theme_classic() +
  theme(axis.text.x = element_text(family = "Arial", vjust = 0.5, size = 20, face ="bold", hjust = 0.5, margin = margin(t = 10, r = 0, b = 0, l = 0)),
        axis.text.y = element_text(family = "Arial", size = 20, face ="bold", margin = margin(t = 0, r = 10, b = 0, l = 0)),
        axis.title.x = element_text(family = "Arial", size = 20, face ="bold", margin = margin(t = 10, r = 0, b = -10, l = 0)),
        axis.title.y = element_text(family = "Arial", size = 20, face ="bold", margin = margin(t = 10, r = 10, b = 0, l = 0)),
        plot.margin = margin(1, 1, 1, 1, "cm"),
        plot.title = element_text(family = "Arial", size = 20, hjust = 0.5, vjust = 1, face= "bold"),
        panel.grid.major = element_line(color = "gray", linetype = "dashed"),
        panel.border = element_rect(color = "black", fill = NA, size = 1))

# Save the plot as an image
ggsave("updated_heatmap_linear_solar_full_family.png", plot = new_heatmap, width = 10, height = 7, dpi = 300)

# Display the plot
print(new_heatmap)

```

```{r}

##SOLAR_Parent_offspring, generation two and three


# Create the initial data frame with the updated RhoG data
data <- data.frame(
  Frequency_comparison = c("250|500", "250|1000", "250|2000", "250|3000", "250|4000", "250|6000", 
                           "250|8000", "500|1000", "500|2000", "500|3000", "500|4000", "500|6000", 
                           "500|8000", "1000|2000", "1000|3000", "1000|4000", "1000|6000", 
                           "1000|8000", "2000|3000", "2000|4000", "2000|6000", "2000|8000", 
                           "3000|4000", "3000|6000", "3000|8000", "4000|6000", "4000|8000", "6000|8000"),
  
   RhoG = c(0.771, 0.469, 0.701, 0.409, 0.465, 0.097, 
           0.1195, 0.778, 0.8595, 0.595, 0.614, 0.097, 
           0.248, 0.756, 0.522, 0.493, -0.099, 
           0.101, 0.618, 0.646, 0.141, 0.248, 
           0.729, 0.594, 0.598, 0.6896, 0.639, 0.965)
)

# Add diagonal entries to the data frame
diagonal_entries <- data.frame(
  Frequency_comparison = c("250|250", "500|500", "1000|1000", "2000|2000", "3000|3000", "4000|4000", "6000|6000", "8000|8000"),
  RhoG = c(1, 1, 1, 1, 1, 1, 1, 1)  # Perfect correlation on the diagonal
)

# Combine the initial data with the diagonal entries
data <- rbind(data, diagonal_entries)

# Split the 'Frequency_comparison' column into 'Freq1' and 'Freq2'
data <- separate(data, Frequency_comparison, into = c("Freq1", "Freq2"), sep = "\\|")

# Convert the split columns to numeric
data$Freq1 <- as.numeric(data$Freq1)
data$Freq2 <- as.numeric(data$Freq2)

# Define all frequencies to ensure axes include all values
all_frequencies <- c(250, 500, 1000, 2000, 3000, 4000, 6000, 8000)

# Create the heatmap with a smooth gradient from blue to red, centered at 0 (white)
new_heatmap <- ggplot(data, aes(x = factor(Freq2, levels = all_frequencies), 
                                y = factor(Freq1, levels = rev(all_frequencies)), 
                                fill = RhoG)) +
  geom_tile() +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", 
                       midpoint = 0, limits = c(-1, 1), 
                       breaks = seq(-1, 1, by = 0.5),
                       name = "Genetic Correlation") +
  scale_x_discrete(position = "top") +
  scale_y_discrete() +  
  labs(x = "Frequency", y = "Frequency") +
  ggtitle("") +
  theme_classic() +
  theme(axis.text.x = element_text(family = "Arial", vjust = 0.5, size = 20, face ="bold", hjust = 0.5, margin = margin(t = 10, r = 0, b = 0, l = 0)),
        axis.text.y = element_text(family = "Arial", size = 20, face ="bold", margin = margin(t = 0, r = 10, b = 0, l = 0)),
        axis.title.x = element_text(family = "Arial", size = 20, face ="bold", margin = margin(t = 10, r = 0, b = -10, l = 0)),
        axis.title.y = element_text(family = "Arial", size = 20, face ="bold", margin = margin(t = 10, r = 10, b = 0, l = 0)),
        plot.margin = margin(1, 1, 1, 1, "cm"),
        plot.title = element_text(family = "Arial", size = 20, hjust = 0.5, vjust = 1, face= "bold"),
        panel.grid.major = element_line(color = "gray", linetype = "dashed"),
        panel.border = element_rect(color = "black", fill = NA, size = 1))

# Save the plot as an image
ggsave("updated_heatmap_linear_solar_partent_offsp.png", plot = new_heatmap, width = 10, height = 7, dpi = 300)

# Display the plot
print(new_heatmap)


```

```{r}
#Siblings generation 3

# Create the initial data frame with the new RhoG data
data <- data.frame(
  Frequency_comparison = c("250|500", "250|1000", "250|2000", "250|3000", "250|4000", "250|6000", 
                           "250|8000", "500|1000", "500|2000", "500|3000", "500|4000", "500|6000", 
                           "500|8000", "1000|2000", "1000|3000", "1000|4000", "1000|6000", 
                           "1000|8000", "2000|3000", "2000|4000", "2000|6000", "2000|8000", 
                           "3000|4000", "3000|6000", "3000|8000", "4000|6000", "4000|8000", "6000|8000"),
  
  RhoG = c(0.817, 0.524, 0.737, 0.474, 0.638, 0.198, 
           0.145, 0.862, 0.927, 0.632, 0.708, 0.094, 
           0.258, 0.815, 0.418, 0.491, -0.194, 
           0.018, 0.6295, 0.624, 0.011, 0.168, 
           0.774, 0.491, 0.62, 0.679, 0.58, 0.995)
)

# Add diagonal entries to the data frame
diagonal_entries <- data.frame(
  Frequency_comparison = c("250|250", "500|500", "1000|1000", "2000|2000", "3000|3000", "4000|4000", "6000|6000", "8000|8000"),
  RhoG = c(1, 1, 1, 1, 1, 1, 1, 1)  # Perfect correlation on the diagonal
)

# Combine the initial data with the diagonal entries
data <- rbind(data, diagonal_entries)

# Split the 'Frequency_comparison' column into 'Freq1' and 'Freq2'
data <- separate(data, Frequency_comparison, into = c("Freq1", "Freq2"), sep = "\\|")

# Convert the split columns to numeric
data$Freq1 <- as.numeric(data$Freq1)
data$Freq2 <- as.numeric(data$Freq2)

# Define all frequencies to ensure axes include all values
all_frequencies <- c(250, 500, 1000, 2000, 3000, 4000, 6000, 8000)

# Create the heatmap with a smooth gradient from blue to red, centered at 0 (white)
new_heatmap <- ggplot(data, aes(x = factor(Freq2, levels = all_frequencies), 
                                y = factor(Freq1, levels = rev(all_frequencies)), 
                                fill = RhoG)) +
  geom_tile() +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", 
                       midpoint = 0, limits = c(-1, 1), 
                       breaks = seq(-1, 1, by = 0.5),
                       name = "Genetic Correlation") +
  scale_x_discrete(position = "top") +
  scale_y_discrete() +  
  labs(x = "Frequency", y = "Frequency") +
  ggtitle("") +
  theme_classic() +
  theme(axis.text.x = element_text(family = "Arial", vjust = 0.5, size = 20, face ="bold", hjust = 0.5, margin = margin(t = 10, r = 0, b = 0, l = 0)),
        axis.text.y = element_text(family = "Arial", size = 20, face ="bold", margin = margin(t = 0, r = 10, b = 0, l = 0)),
        axis.title.x = element_text(family = "Arial", size = 20, face ="bold", margin = margin(t = 10, r = 0, b = -10, l = 0)),
        axis.title.y = element_text(family = "Arial", size = 20, face ="bold", margin = margin(t = 10, r = 10, b = 0, l = 0)),
        plot.margin = margin(1, 1, 1, 1, "cm"),
        plot.title = element_text(family = "Arial", size = 20, hjust = 0.5, vjust = 1, face= "bold"),
        panel.grid.major = element_line(color = "gray", linetype = "dashed"),
        panel.border = element_rect(color = "black", fill = NA, size = 1))

# Save the plot as an image
ggsave("updated_heatmap_linear_solar_siblings.png", plot = new_heatmap, width = 10, height = 7, dpi = 300)

# Display the plot
print(new_heatmap)

```
